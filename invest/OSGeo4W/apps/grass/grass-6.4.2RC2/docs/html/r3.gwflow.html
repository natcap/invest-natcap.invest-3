<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>GRASS GIS manual: r3.gwflow</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="grassdocs.css" type="text/css">
</head>
<body bgcolor="white">

<img src="grass_logo.png" alt="GRASS logo"><hr align=center size=6 noshade>

<h2>NAME</h2>
<em><b>r3.gwflow</b></em>  - Calculates numerically transient, confined groundwater flow in three dimensions.
<h2>KEYWORDS</h2>
raster3d, voxel
<h2>SYNOPSIS</h2>
<b>r3.gwflow</b><br>
<b>r3.gwflow help</b><br>
<b>r3.gwflow</b> [-<b>ms</b>] <b>phead</b>=<em>string</em> <b>status</b>=<em>string</em> <b>hc_x</b>=<em>string</em> <b>hc_y</b>=<em>string</em> <b>hc_z</b>=<em>string</em>  [<b>q</b>=<em>string</em>]  <b>s</b>=<em>string</em>  [<b>r</b>=<em>string</em>]  <b>output</b>=<em>string</em>  [<b>velocity</b>=<em>string</em>]  <b>dt</b>=<em>float</em>  [<b>maxit</b>=<em>integer</em>]   [<b>error</b>=<em>float</em>]   [<b>solver</b>=<em>name</em>]   [<b>relax</b>=<em>float</em>]   [--<b>overwrite</b>]  [--<b>verbose</b>]  [--<b>quiet</b>] 

<h3>Flags:</h3>
<DL>
<DT><b>-m</b></DT>
<DD>Use 3D raster mask (if exists) with input maps</DD>

<DT><b>-s</b></DT>
<DD>Use a sparse linear equation system, only available with iterative solvers</DD>

<DT><b>--overwrite</b></DT>
<DD>Allow output files to overwrite existing files</DD>
<DT><b>--verbose</b></DT>
<DD>Verbose module output</DD>
<DT><b>--quiet</b></DT>
<DD>Quiet module output</DD>
</DL>

<h3>Parameters:</h3>
<DL>
<DT><b>phead</b>=<em>string</em></DT>
<DD>Input 3D raster map with initial piezometric heads in [m]</DD>

<DT><b>status</b>=<em>string</em></DT>
<DD>The status for each cell, = 0 - inactive, 1 - active, 2 - dirichlet</DD>

<DT><b>hc_x</b>=<em>string</em></DT>
<DD>The x-part of the hydraulic conductivity tensor in [m/s]</DD>

<DT><b>hc_y</b>=<em>string</em></DT>
<DD>The y-part of the hydraulic conductivity tensor in [m/s]</DD>

<DT><b>hc_z</b>=<em>string</em></DT>
<DD>The z-part of the hydraulic conductivity tensor in [m/s]</DD>

<DT><b>q</b>=<em>string</em></DT>
<DD>Sources and sinks in [m^3/s]</DD>

<DT><b>s</b>=<em>string</em></DT>
<DD>Specific yield in 1/m</DD>

<DT><b>r</b>=<em>string</em></DT>
<DD>Recharge raster map in m^3/s</DD>

<DT><b>output</b>=<em>string</em></DT>
<DD>The piezometric head result of the numerical calculation will be written to this map</DD>

<DT><b>velocity</b>=<em>string</em></DT>
<DD>Calculate the groundwater distance velocity vector field <br>and write the x, y, and z components to maps named name_[xyz].<br>Name is basename for the new 3D raster maps.</DD>

<DT><b>dt</b>=<em>float</em></DT>
<DD>The calculation time in seconds</DD>
<DD>Default: <em>86400</em></DD>

<DT><b>maxit</b>=<em>integer</em></DT>
<DD>Maximum number of iteration used to solver the linear equation system</DD>
<DD>Default: <em>100000</em></DD>

<DT><b>error</b>=<em>float</em></DT>
<DD>Error break criteria for iterative solvers (jacobi, sor, cg or bicgstab)</DD>
<DD>Default: <em>0.0000000001</em></DD>

<DT><b>solver</b>=<em>name</em></DT>
<DD>The type of solver which should solve the symmetric linear equation system</DD>
<DD>Options: <em>gauss,lu,cholesky,jacobi,sor,cg,bicgstab,pcg</em></DD>
<DD>Default: <em>cg</em></DD>

<DT><b>relax</b>=<em>float</em></DT>
<DD>The relaxation parameter used by the jacobi and sor solver for speedup or stabilizing</DD>
<DD>Default: <em>1</em></DD>

</DL>
<h2>DESCRIPTION</h2>

This numerical module calculates transient, confined groundwater flow 
in three dimensions based on volume maps and the current 3D region resolution.
All initial- and boundary-conditions must be provided as 
volume maps.

<p>
The module calculates the piezometric head and optionally the 
groundwater velocity field.
The vector components can be visualized with ParaView if they are exported
with <em>r3.out.vtk</em>.

<p>
The groundwater flow will always be calculated transient. 
For steady state computation the user should set the timestep
to a large number (billions of seconds) or set the
specific yield raster map to zero.

<h2>NOTES</h2>

The groundwater flow calculation is based on Darcy's law and a 
finite volume discretization. The groundwater flow partial
differential equation is of the following form:

<p>
(dh/dt)*S = Kxx * (d^2h/dx^2) + Kyy * (d^2h/dy^2) + Kzz * (d^2h/dz^2) + q

<ul>
<li>h -- the piezometric head im meters [m]</li>
<li>dt -- the time step for transient calculation in seconds [s]</li>
<li>S -- the specific yield  [1/m]</li>
<li>b -- the bottom surface of the aquifer meters [m]</li>
<li>Kxx -- the hydraulic conductivity tensor part in x direction in meter per second [m/s]</li>
<li>Kyy -- the hydraulic conductivity tensor part in y direction in meter per seconds [m/s]</li>
<li>Kzz -- the hydraulic conductivity tensor part in z direction in meter per seconds [m/s]</li>
<li>q - inner source in [1/s]</li>
</ul>

<p>
Two different boundary conditions are implemented, 
the Dirichlet and Neumann conditions. By default the calculation 
area is surrounded by homogeneous Neumann boundary conditions.
The calculation and boundary status of single cells can be set with 
the status map, the following cell states are supported:

<ul>
<li>0 == inactive - the cell with status 0 will not be calulated,
 active cells will have a no flow boundary to an inactive cell</li>
<li>1 == active - this cell is used for groundwater calculation,
 inner sources can be defined for those cells</li>
<li>2 == Dirichlet - cells of this type will have a fixed piezometric
 head value which do not change over time </li>
</ul>

<p>
The groundwater flow equation can be solved with several numerical solvers.

Additionally a direct Gauss solver and a LU solver are available. Those direct solvers
only work with quadratic matrices, so be careful using them with large maps 
(maps of size 10.000 cells will need more than one Gigabyte of RAM).

<h2>EXAMPLE</h2>
This small script creates a working groundwater flow area and
data. It cannot be run in a lat/lon location.

<div class="code"><pre>
# set the region accordingly
g.region res=25 res3=25 t=100 b=0 n=1000 s=0 w=0 e=1000 -p

#now create the input raster maps for a confined aquifer
r3.mapcalc "phead = if(row() == 1 && depth() == 4, 50, 40)"
r3.mapcalc "status = if(row() == 1 && depth() == 4, 2, 1)"
r3.mapcalc "well = if(row() == 20 && col() == 20 , -0.00025, 0)"
r3.mapcalc "hydcond = 0.00025"
r3.mapcalc "syield = 0.0001"
r.mapcalc  "recharge = 0.0"

r3.gwflow -s solver=cg phead=phead status=status hc_x=hydcond hc_y=hydcond  \
hc_z=hydcond q=well s=syield r=recharge output=gwresult dt=8640000 velocity=gwresult_velocity

# The data can be visualized with ParaView when exported with r3.out.vtk
r3.out.vtk -p in=gwresult,status vector=gwresult_velocity_x,gwresult_velocity_y,gwresult_velocity_z out=/tmp/gwdata3d.vtk

#now load the data into ParaView
paraview --data=/tmp/gwdata3d.vtk
</pre></div>

<h2>SEE ALSO</h2>

<em>
<a href="r.gwflow.html">r.gwflow</a>,
<a href="r3.out.vtk.html">r3.out.vtk</a>
</em>

<h2>AUTHOR</h2>
S&ouml;ren Gebbert
<p>
This work is based on the Diploma Thesis of S&ouml;ren Gebbert available
<a href="http://www.hydrogeologie.tu-berlin.de/fileadmin/fg66/_hydro/Diplomarbeiten/2007_Diplomarbeit_S&ouml;ren_Gebbert.pdf">here</a>
at Technical University Berlin, Germany.

<p><i>Last changed: $Date: 2011-09-13 22:13:36 +0200 (Ãºt, 13 IX 2011) $</i>
<HR>
<P><a href="index.html">Main index</a> - <a href="raster3D.html">raster3D index</a> - <a href="full_index.html">Full index</a></P>
<P>&copy; 2003-2011 <a href="http://grass.osgeo.org">GRASS Development Team</a></p>
</body>
</html>
