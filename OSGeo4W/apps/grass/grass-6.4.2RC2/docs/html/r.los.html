<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>GRASS GIS manual: r.los</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="grassdocs.css" type="text/css">
</head>
<body bgcolor="white">

<img src="grass_logo.png" alt="GRASS logo"><hr align=center size=6 noshade>

<h2>NAME</h2>
<em><b>r.los</b></em>  - Line-of-sight raster analysis program.
<h2>KEYWORDS</h2>
raster, viewshed
<h2>SYNOPSIS</h2>
<b>r.los</b><br>
<b>r.los help</b><br>
<b>r.los</b> [-<b>c</b>] <b>input</b>=<em>name</em> <b>output</b>=<em>name</em> <b>coordinate</b>=<em>x,y</em>  [<b>patt_map</b>=<em>name</em>]   [<b>obs_elev</b>=<em>float</em>]   [<b>max_dist</b>=<em>float</em>]   [--<b>overwrite</b>]  [--<b>verbose</b>]  [--<b>quiet</b>] 

<h3>Flags:</h3>
<DL>
<DT><b>-c</b></DT>
<DD>Consider earth curvature (current ellipsoid)</DD>

<DT><b>--overwrite</b></DT>
<DD>Allow output files to overwrite existing files</DD>
<DT><b>--verbose</b></DT>
<DD>Verbose module output</DD>
<DT><b>--quiet</b></DT>
<DD>Quiet module output</DD>
</DL>

<h3>Parameters:</h3>
<DL>
<DT><b>input</b>=<em>name</em></DT>
<DD>Name of elevation raster map</DD>

<DT><b>output</b>=<em>name</em></DT>
<DD>Name for output raster map</DD>

<DT><b>coordinate</b>=<em>x,y</em></DT>
<DD>Coordinate identifying the viewing position</DD>

<DT><b>patt_map</b>=<em>name</em></DT>
<DD>Binary (1/0) raster map to use as a mask</DD>

<DT><b>obs_elev</b>=<em>float</em></DT>
<DD>Viewing position height above the ground</DD>
<DD>Default: <em>1.75</em></DD>

<DT><b>max_dist</b>=<em>float</em></DT>
<DD>Maximum distance from the viewing point (meters)</DD>
<DD>Options: <em>0-5000000</em></DD>
<DD>Default: <em>10000</em></DD>

</DL>
<h2>DESCRIPTION</h2>


<em>r.los</em> generates a raster output map in which the cells that are
visible from a user-specified observer position are marked with the
vertical angle (in degrees) required to see those cells (viewshed).
A value of 0 is directly below the specified viewing position,
90 is due horizontal, and 180 is directly above the observer.
The angle to the cell containing the viewing position is undefined
and set to 180.

<p>
To run <em>r.los</em>, the user must specify at least 
an <b>input</b> map name, <b>output</b> map name, and the geographic 
<b>coordinate</b>s of the user's viewing location; 
any remaining parameters whose values are unspecified 
will be set to their default values (see below). 

<p>
The <b>patt_map</b> is the name of a binary (1/0) raster map layer in which
cells within the areas of interest are assigned the category value '1', and
all other cells are assigned the category value '0' or NULL. If this parameter is
omitted, the analysis will be performed for the whole area within a certain
distance of the viewing point inside the geographic region boundaries.
<br>
Default: assign all cells that are within the <b>max_dist</b> and within
the user's current geographic region boundaries a value of 1.

<p>
The <b>obs_elev</b> parameter defines the height of the observer (in
meters) above the viewing point's elevation.
<p>

The <b>max_dist</b> parameter is the maximum distance (in meters) from the
viewing point inside of which the line of sight analysis will be performed.
The cells outside this distance range are assigned a NULL value.


<h2>NOTES</h2>

For accurate results, the program must be run with the resolution of the 
geographic region set equal to the resolution of the data 
(see <em><a href="g.region.html">g.region</a></em>).

<p>
The time to complete the calculation increases dramatically with the region size.
Try to keep the columns and rows under 1000.

<p>
It is advisable to use a 'pattern layer' which identifies
the areas of interest in which the line of sight analysis
is required.  Such a measure will reduce the time taken by
the program to run.

<p>
The curvature of the Earth is not taken into account for these calculations.
However, for interest's sake, a handy calculation for distance to the true horizon
is approximated by <i>d = sqrt(13*h)</i> where <i>h</i> is the height of the observer
in meters (above sea level) and <i>d</i> is the distance to the horizon in km.
This may be useful for setting the <b>max_dist</b> value.


<h2>EXAMPLE</h2>

Spearfish example - calculation of viewshed from 50m tower
on top of a mountain:

<div class="code"><pre>
g.region rast=elevation.dem -p
r.los elevation.dem out=los coord=598869,4916642 obs_elev=50 max_dist=10000
r.colors -e los color=bgyr
d.shadedmap relief=aspect drape=los bright=10
echo "symbol extra/target 25 598869 4916642 red" | d.graph -m
</pre></div>

<h2>TODO</h2>

a) Rewrite using ideas from <em>r.cva</em> and a method which scales better
to large regions.<br>A suggested method is detailed in:<br>
Izraelevitz, David (USACE).<br>
'A Fast Algorithm for Approximate Viewshed Computation'<br>
<i>Photogrammetric Engineering & Remote Sensing</i>, July 2003
<!-- http://article.gmane.org/gmane.comp.gis.grass.devel/1781
  Post by Paul Kelly 2003-08-13 to grass-dev, 
  "Re: [bug #2061] (grass) r.los needs FP update" -->

b) or fix r.viewshed in Addons

<h2>SEE ALSO</h2>

<em><a href="g.region.html">g.region</a></em>

<h2>AUTHOR</h2>

Kewan Q. Khawaja, Intelligent Engineering Systems Laboratory, M.I.T.

<p>
<i>Last changed: $Date: 2008-12-14 12:25:21 +0100 (ne, 14 XII 2008) $</i>
<HR>
<P><a href="index.html">Main index</a> - <a href="raster.html">raster index</a> - <a href="full_index.html">Full index</a></P>
<P>&copy; 2003-2011 <a href="http://grass.osgeo.org">GRASS Development Team</a></p>
</body>
</html>
