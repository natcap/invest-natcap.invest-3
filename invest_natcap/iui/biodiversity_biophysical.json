{
    "id" : "window",
    "label": "Biodiversity: Biophysical",
    "targetScript" : "invest_natcap.biodiversity.biodiversity_biophysical",
    "modelName" : "biodiversity_biophysical",
    "localDocURI": "../documentation/biodiversity.html",
    "height": 500,
    "width" : 700,
    "elements": [
        {
            "id" : "workspace_list",
            "type": "list",
            "elements":[
                {
                    "id" : "workspace",
                    "args_id" : "workspace_dir",
                    "type": "folder",
                    "label": "Workspace",
                    "defaultValue": "../Biodiversity",
                    "required": true,
                    "validateAs": {"type": "folder"},
                    "helpText": "Select a folder to be used as your workspace.  If the folder you select does not exist, it will be created for you.<br/><br/>This folder will contain the rasters produced by this model.  <b>If datasets already exist in this folder, they will be overwritten</b>."
                },
                {        
                    "id" : "current_landcover",
                    "args_id" : "landuse_cur_uri",
                    "type": "file",
                    "label": "Current land cover map",
                    "defaultValue": "../Biodiversity/Input/lc_samp_cur_b/w001001.adf",
                    "required": true,
                    "validateAs": {"type": "GDAL"},
                    "helpText": "This must be a raster dataset that GDAL can open. Each cell should represent a LULC code as an Integer. The dataset should be in a projection where the units are in meters and the projection used should be defined. The LULC codes must match the codes in the Sensitivity table"
                },
                {        
                    "id" : "future_landcover",
                    "args_id" : "landuse_fut_uri",
                    "type": "file",
                    "label": "Future land cover map (optional)",
                    "defaultValue": "",
                    "required": false,
                    "validateAs": {"type": "GDAL"},
                    "returns": {"ifEmpty": "pass"},
                    "helpText": "This input is optional but if provided must be a raster dataset that GDAL can open. Each cell should represent a LULC code as an Integer. The dataset should be in a projection where the units are in meters and the projection used should be defined. The LULC codes must match the codes in the Sensitivity table"
                },
                {        
                    "id" : "baseline_landcover",
                    "args_id" : "landuse_bas_uri",
                    "type": "file",
                    "label": "Baseline land cover map (optional)",
                    "defaultValue": "",
                    "required": false,
                    "validateAs": {"type": "GDAL"},
                    "returns": {"ifEmpty": "pass"},
                    "helpText": "This input is optional but if provided must be a raster dataset that GDAL can open. Each cell should  represent a LULC code as an Integer. The dataset should be in a projection where the units are in meters and the projection used should be defined. The LULC codes must match the codes in the Sensitivity table. If possible the baseline map should refer to a time when intensive management of the landscape was relatively rare."
                },       
                {
                    "id" : "threats_data",
                    "args_id": "threats_uri",
                    "type": "file",
                    "label": "Threats data",
                    "defaultValue": "../Biodiversity/Input/threats_samp.csv",
                    "required": true,
                    "validateAs": { "type": "CSV",
                                    "fieldsExist": ["THREAT", "MAX_DIST", "WEIGHT"],
                                    "restrictions": [{"field": "THREAT",
                                                    "validateAs":{"type": "string",
                                                                  "allowedValues": {"pattern":"^[a-zA-Z0-9_]+$"}
                                                                  }},
                                                     {"field": "MAX_DIST",
                                                      "validateAs": {"type": "number",
                                                                     "allowedValues":{"pattern":"^[0-9]*\\.?[0-9]+$"}
                                                                  }},
                                                     {"field": "WEIGHT",
                                                      "validateAs": {"type": "number",
                                                                     "allowedValues":{"pattern":"(^[0]*\\.?[0-9]+$)|(^[1]\\.?[0]+$)"}
                                                                  }}]},
                    "helpText":"A CSV file of all the threats for the model to consider. Each row in the table is a degradation source and each column contains a different attribute of each degradation source (THREAT, MAX_DIST, WEIGHT, DECAY). See the user's guide for valid values for these columns."
                },
                {
                    "id" : "accessibility_threats",
                    "args_id": "access_uri",
                    "type": "file",
                    "label": "Accessibility to threats (optional)",
                    "defaultValue": "../Biodiversity/Input/access_samp.shp",
                    "required": false,
                    "validateAs": {"type": "OGR", 
                                   "layers": [{"name": {"inheritFrom": "file"}, 
                                               "type": "polygons"
                                             }],
                                   "fieldsExist": ["ACCESS"]
                                   },
                    "returns": {"ifEmpty": "pass"},
                    "helpText": "This must be a polygon shapefile that OGR can open. The input contains data on the relative protection that legal / institutional / social / physical barriers provide against threats. Should contain polygons with values ranging from 0 - 1 where 1 is fully accessible. Any cells not covered by a polygon will be set to 1."
                },
                {
                    "id" : "sensitivity_data",
                    "args_id": "sensitivity_uri",
                    "type": "file",
                    "label": "Sensitivity of land cover types to each threat",
                    "defaultValue": "../Biodiversity/Input/sensitivity_samp.csv",
                    "required": true,
                    "validateAs": { "type": "CSV",
                                    "fieldsExist": ["LULC", "NAME", "HABITAT"],
                                    "restrictions": [{"field": "LULC",
                                                    "validateAs":{"type": "number",
                                                                  "allowedValues": {"pattern":"^[0-9].*"}
                                                                  }},
                                                     {"field": "NAME",
                                                      "validateAs": {"type": "string",
                                                                     "allowedValues":{"pattern":"[a-zA-Z0-9_].*"}}
                                                                  },
                                                     {"field": "HABITAT",
                                                      "validateAs": {"type": "number",
                                                                     "allowedValues":{"pattern":"^[0]*\\.?[0-9]+$"}
                                                                  }}]},
                    "helpText":"A CSV file of LULC types, whether or not the are considered habitat, and, for LULC types that are habitat, their specific sensitivity to each threat. Each row is a LULC type with the following columns: LULC, NAME, HABITAT, L_THREAT1, L_THREAT2, ... Each L_THREATN should match exactly with the threat names given in the threat CSV file, where the THREATN is what matches. Please see the users guide for more detailed information on proper column values and column names for each threat."
                },
                {
                    "id" : "half_saturation_constant",
                    "args_id" : "half_saturation_constant",
                    "type": "text",
                    "validText": "^[0-9]*\\.?[0-9]+$",
                    "validateAs": {"type" : "number",
                                   "allowedValues" : {"pattern" : "^[0-9]*\\.?[0-9]+$"}},
                    "label": "Half-saturation constant",
                    "defaultValue": "0.5",
                    "required": true,
                    "helpText":"A positive floating point value that is defaulted at 30. This is the value of the parameter k in equation (4). In general, set k to half of the highest grid cell degradation value on the landscape. To perform this model calibration you will have to run the model once to find the highest degradation value and set k for your landscape. Note that the choice of k only determines the spread and central tendency of habitat quality cores."
                },                         
                {
                    "id" : "results_suffix",
                    "args_id" : "suffix",
                    "type": "text",
                    "dataType": "string",
                    "validText": "[a-zA-Z0-9]*",
                    "label": "Results Suffix (optional)",
                    "defaultValue": "",
                    "required": false,
                    "helpText":"A String that will be added to the end of the output uris."

                }                         
            ]
        }
    ]
}
