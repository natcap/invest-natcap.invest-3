{
    "id": "window",
    "label": "Coastal Vulnerability Assesment Tool",
    "targetScript": "invest_natcap.coastal_vulnerability.coastal_vulnerability",
    "modelName": "coastal_vulnerability",
    "localDocURI": "../documentation/coastal_vulnerability.html",
    "height": 1500,
    "width": 1000,
    "elements": [
        {
            "id": "coastal_vulnerability_list",
            "type": "list",
            "elements": [
                {
                    "label": "Output area: sheltered/exposed?",
                    "id": "area_computed",
                    "args_id": "area_computed",
                    "type": "dropdown",
                    "defaultValue": "Both",
                    "options": ["both", "sheltered"],
                    "required": true,
                    "returns": "strings",
                    "helpText": "Determine if the output data is about all the coast or about sheltered segments only."
                },
                {
                    "label": "Working directory",
                    "id":"working_directory",
                    "type": "folder",
                    "required": true,
                    "validateAs": {"type":"folder"},
                    "args_id": "workspace_dir",
                    "defaultValue": "../coastal_vulnerability",
                    "helpText": "Existing directory from where the model will look for the input data."
                },
                {
                    "label": "Write data to:",
                    "id":"output_base_directory",
                    "type": "folder",
                    "required": true,
                    "validateAs": {"type":"folder"},
                    "args_id": "output_base_directory",
                    "defaultValue": "../coastal_vulnerability",
                    "helpText": "Directory where to create the intermediate and outputs directories. If the directory doesn't exist, it will be created."
                },
                {
                    "label": "Area of interest",
                    "id": "area_of_interest",
                    "args_id": "aoi_uri",
                    "type": "file",
                    "required": true,
                    "defaultValue":
                    "../CoastalProtection/Input/AOI_BarkClay.shp",
                    "validateAs":{"type":"OGR",
                                  "layers": [{"name": {"inheritFrom":"file"},
                                  "type":"polygons"}]},
                    "helpText": "Single feature polygon shapefile. All outputs will be in the AOI's projection."
                },
                {
                    "label": "Land polygon",
                    "id": "landmass_uri",
                    "args_id": "landmass_uri",
                    "type": "file",
                    "required": true,
                    "defaultValue":
                    "../Base_Data/Marine/Land/global_polygon.shp",
                    "validateAs":{"type":"OGR",
                                  "layers": [{"name": {"inheritFrom":"file"},
                                  "type":"polygons"}]},
                    "helpText": "Landmass polygon shapefile from where the coastline will be extracted. The default is the global land polygon."
                },
                {
                    "label": "Bathymetry layer",
                    "id": "bathymetry_layer",
                    "args_id": "bathymetry_uri",
                    "type": "file",
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "defaultValue":
                    "../Base_Data/Marine/DEMs/claybark_dem/hdr.adf",
                    "validateAs":{"type":"GDAL"},
                    "helpText": "Digital elevation Model file (DEM) or Geo TIFF raster file (tif) of terrain elevation in the area of interest. Used to compute depths along fetch rays, relief and surge potential."
                },
                {
                    "label": "Layer value if path omitted",
                    "id": "bathymetry_constant",
                    "args_id": "bathymetry_constant",
                    "type": "text",
                    "width": 70,
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "dataType": "int",
                    "validText": "[1-5]",
                    "defaultValue": "",
                    "helpText": "Integer value between 1 and 5. If layer associated to this field is omitted, replace all shore points for this layer with a constant rank value in the computation of the coastal vulnerability index. If both the file and value for the layer are omitted, the layer is skipped altogether."
                },
                {
                    "label": "Relief",
                    "id": "relief",
                    "args_id": "relief_uri",
                    "type": "file",
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "defaultValue":
                    "../Base_Data/Marine/DEMs/claybark_dem/hdr.adf",
                    "validateAs":{"type":"GDAL"},
                    "helpText": "DEM or raster file (tif) of land elevation used to compute the average land elevation within a user-defined radius (see Elevation averaging radius)."
                },
                {
                    "label": "Layer value if path omitted",
                    "id": "relief_constant",
                    "args_id": "relief_constant",
                    "type": "text",
                    "width": 70,
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "dataType": "int",
                    "validText": "[1-5]",
                    "defaultValue": "",
                    "helpText": "Integer value between 1 and 5. If layer associated to this field is omitted, replace all shore points for this layer with a constant rank value in the computation of the coastal vulnerability index. If both the file and value for the layer are omitted, the layer is skipped altogether."
                },
                {
                    "label": "Elevation averaging radius (m)",
                    "id": "elevation_averaging_radius",
                    "args_id": "elevation_averaging_radius",
                    "type": "text",
                    "width": 70,
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "dataType": "int",
                    "validText": "[0-9]+",
                    "defaultValue": "5000",
                    "helpText": "Distance in meters (integer). Each pixel average elevation will be computed within this radius."
                },
                {
                    "label": "Mean sea level datum (m)",
                    "id": "mean_sea_level_datum",
                    "args_id": "mean_sea_level_datum",
                    "type": "text",
                    "width": 70,
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "dataType": "int",
                    "validText": "[0-9]+",
                    "defaultValue": "0",
                    "helpText": "Height in meters (integer). This input is the elevation of Mean Sea Level (MSL) datum relative to the datum of the bathymetry layer. The model transforms all depths to MSL datum. A positive value means the MSL is higher than the bathymetry's zero (0) elevation, so the value is subtracted from the bathymetry."
                },
                {
                    "label": "Smallest detectable feature (segment size)",
                    "id": "cell_size",
                    "args_id": "cell_size",
                    "type": "text",
                    "width": 70,
                    "required": true,
                    "dataType": "int",
                    "validText": "[0-9]+",
                    "defaultValue": "250",
                    "helpText": "Cell size in meters. The higher the value, the faster the computation, but the coarser the output rasters produced by the model."
                },
                {
                    "label": "Rays per sector",
                    "id": "rays_per_sector",
                    "args_id": "rays_per_sector",
                    "type": "text",
                    "width": 70,
                    "required": true,
                    "dataType": "int",
                    "validText": "[0-9]+",
                    "defaultValue": "1",
                    "helpText": "Number of rays used to subsample the fetch distance within each of the 16 sectors."
                },
                {
                    "label": "Fetch distance threshold (m)",
                    "id": "max_fetch",
                    "args_id": "max_fetch",
                    "type": "text",
                    "width": 70,
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "dataType": "int",
                    "validText": "[0-9]+",
                    "defaultValue": "12000",
                    "helpText": "Fetch distance in meters (integer) used to determine if a shore segment is exposed to the open ocean."
                },
                {
                    "label": "Depth threshold (m)",
                    "id": "depth_threshold",
                    "args_id": "depth_threshold",
                    "type": "text",
                    "width": 70,
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "dataType": "int",
                    "validText": "[0-9]+",
                    "defaultValue": "0",
                    "helpText": "Depth in meters (integer) cutoff to determine if fetch rays project over deep areas."
                },
                {
                    "label": "Exposure proportion",
                    "id" : "exposure_proportion",
                    "type": "text",
                    "args_id": "exposure_proportion",
                    "required": true,
                    "width": 60,
                    "defaultValue": "0.8",
                    "validateAs": {"type": "number",
                                   "lteq": 1,
                                   "gteq": 0},
                    "dataType": "float",
                    "helpText": "Minimum proportion of rays that project over exposed and/or deep areas need to classify a shore segment as exposed."
                },
                {
                    "label": "Oceanic effect cutoff (m)",
                    "id": "H_threshold",
                    "args_id": "H_threshold",
                    "type": "text",
                    "width": 70,
                    "required": true,
                    "dataType": "int",
                    "validText": "[0-9]+",
                    "defaultValue": "12000",
                    "helpText": "Threshold used to set the <i>H[Fk]</i> function in equation 7 of the documentation. For more information see the section about <a href=\"http://ncp-dev.stanford.edu/~dataportal/invest-releases/documentation/current_release/coastal_vulnerability.html#wave-exposure\">wave exposure</a>."
                },
                {
                    "label": "Geomorphology",
                    "id": "geomorphology_uri",
                    "args_id": "geomorphology_uri",
                    "type": "file",
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "defaultValue":
                    "../CoastalProtection/Input/Geomorphology_BarkClay.shp",
                    "returns" : {"ifEmpty":"pass"},
                    "validateAs":{"type":"OGR",
                                  "layers": [{"name": {"inheritFrom":"file"},
                                  "type":"polygons"}]},
                    "helpText": "Polygon shapefile that has a field called \"RANK\" with values between 1 and 5 in the attribute table."
                },
                {
                    "label": "Layer value if path omitted",
                    "id": "geomorphology_constant",
                    "args_id": "geomorphology_constant",
                    "type": "text",
                    "width": 70,
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "dataType": "int",
                    "validText": "[1-5]",
                    "defaultValue": "",
                    "helpText": "Integer value between 1 and 5. If layer associated to this field is omitted, replace all shore points for this layer with a constant rank value in the computation of the coastal vulnerability index. If both the file and value for the layer are omitted, the layer is skipped altogether."
                },
                {
                    "label": "Coastal overlap (m)",
                    "id": "spread_radius",
                    "args_id": "spread_radius",
                    "type": "text",
                    "width": 70,
                    "required": true,
                    "dataType": "int",
                    "validText": "[0-9]+",
                    "defaultValue": "250",
                    "helpText": "Integer multiple of 'cell size'. The coast from the geomorphology layer could be of a better resolution than the global landmass, so the shores do not necessarily overlap. To make them coincide, the shore from the geomorphology layer is widened by 1 or more pixels. The value should be a multiple of 'cell size' that indicates how many pixels the coast from the geomorphology layer is widened. The widening happens on each side of the coast (n pixels landward, and n pixels seaward)."
                },
                {
                    "label": "Natural habitats directory",
                    "id":"habitats_directory_uri",
                    "args_id": "habitats_directory_uri",
                    "type": "folder",
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "defaultValue":
                    "../CoastalProtection/Input/NaturalHabitat",
                    "helpText": "Directory that contains the polygon shapefiles associated with every natural habitats. The name of these shapefiles should be suffixed with the ID that is specified in the natural habitats CSV file provided along with the habitats."
                },
                {
                    "label": "Natural habitats .CSV table",
                    "id": "habitats_csv_uri",
                    "args_id": "habitats_csv_uri",
                    "type": "file",
                    "requiredIf": ["habitats_directory_uri"],
                    "enabledBy" : "habitats_directory_uri",
                    "defaultValue":
                    "../CoastalProtection/Input/NaturalHabitat_WCVI.csv",
                    "validateAs":{"type":"CSV"},
                    "helpText": "Comma-separated text file listing the attributes for each habitat. For more information see <a href=\"http://ncp-dev.stanford.edu/~dataportal/invest-releases/documentation/current_release/coastal_vulnerability.html#habitat-data-layer\">natural habitats data layer</a>."
                },
                {
                    "label": "Layer value if path omitted",
                    "id": "habitats_constant",
                    "args_id": "habitat_constant",
                    "type": "text",
                    "width": 70,
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "dataType": "int",
                    "validText": "[1-5]",
                    "defaultValue": "",
                    "helpText": "Integer value between 1 and 5. If layer associated to this field is omitted, replace all shore points for this layer with a constant rank value in the computation of the coastal vulnerability index. If both the file and value for the layer are omitted, the layer is skipped altogether."
                },
                {
                    "label": "Climatic forcing grid",
                    "id": "climatic_forcing_uri",
                    "args_id": "climatic_forcing_uri",
                    "type": "file",
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "defaultValue":
                    "../CoastalProtection/Input/WaveWatchIII.shp",
                    "validateAs":{"type":"OGR",
                                  "layers": [{"name": {"inheritFrom":"file"},
                                  "type":"points"}]},
                    "helpText": "Point shapefile Containing both wind and wave information across the regoin of interest."
                },
                {
                    "label": "Layer value if path omitted",
                    "id": "climatic_forcing_constant",
                    "args_id": "climatic_forcing_constant",
                    "type": "text",
                    "width": 70,
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "dataType": "int",
                    "validText": "[1-5]",
                    "defaultValue": "",
                    "helpText": "Integer value between 1 and 5. If layer associated to this field is omitted, replace all shore points for this layer with a constant rank value in the computation of the coastal vulnerability index. If both the file and value for the layer are omitted, the layer is skipped altogether."
                },
                {
                    "label": "Continental shelf",
                    "id": "continental_shelf_uri",
                    "args_id": "continental_shelf_uri",
                    "type": "file",
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "defaultValue":
                    "../CoastalProtection/Input/continentalShelf.shp",
                    "validateAs":{"type":"OGR",
                                  "layers": [{"name": {"inheritFrom":"file"},
                                  "type":"polygons"}]},
                    "helpText": "Polygon shapefile delineating the edges of the continental shelf. Default is global continental shelf shapefile. If omitted, the user can specify depth contour. See entry below."
                },                {
                    "label": "Depth countour level (m)",
                    "id" : "depth_contour",
                    "args_id": "depth_contour",
                    "type": "text",
                    "width": 60,
                    "required": false,
                    "dataType": "int",
                    "defaultValue": "150",
                    "helpText": "Used to delineate shallow and deep areas. Continental shelf limit is at about 150m."
                },
                {
                    "label": "Sea level rise",
                    "id": "sea_level_rise_uri",
                    "args_id": "sea_level_rise_uri",
                    "type": "file",
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "defaultValue":
                    "../CoastalProtection/Input/SeaLevRise_WCVI.shp",
                    "validateAs":{"type":"OGR",
                                  "layers": [{"name": {"inheritFrom":"file"}}]},
                    "helpText": "Point or polygon shapefile where each feature has a field \"Trend\" in the attributes table."
                },
                {
                    "label": "Layer value if path omitted",
                    "id": "sea_level_rise_constant",
                    "args_id": "sea_level_rise_constant",
                    "type": "text",
                    "width": 70,
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "dataType": "int",
                    "validText": "[1-5]",
                    "defaultValue": "",
                    "helpText": "Integer value between 1 and 5. If layer associated to this field is omitted, replace all shore points for this layer with a constant rank value in the computation of the coastal vulnerability index. If both the file and value for the layer are omitted, the layer is skipped altogether."
                },
                {
                    "label": "Structures",
                    "id": "structures_uri",
                    "args_id": "structures_uri",
                    "type": "file",
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "defaultValue":
                    "../CoastalProtection/Input/Structures_BarkClay.shp",
                    "validateAs":{"type":"OGR",
                                  "layers": [{"name": {"inheritFrom":"file"},
                                  "type":"polygon"}]},
                    "helpText": "Polygon shapefile containing rigid structures used to identify the portions of the coast that is armored."
                },
                {
                    "label": "Layer value if path omitted",
                    "id": "structures_constant",
                    "args_id": "structures_constant",
                    "type": "text",
                    "width": 70,
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "dataType": "int",
                    "validText": "[1-5]",
                    "defaultValue": "",
                    "helpText": "Integer value between 1 and 5. If layer associated to this field is omitted, replace all shore points for this layer with a constant rank value in the computation of the coastal vulnerability index. If both the file and value for the layer are omitted, the layer is skipped altogether."
                },
                {
                    "label": "Population layer",
                    "id": "population_uri",
                    "args_id": "population_uri",
                    "type": "file",
                    "required": true,
                    "defaultValue":
                    "../Base_Data/Marine/Population/global_pop/w001001.adf",
                    "validateAs":{"type":"GDAL"},
                    "helpText": "GeoTiff Raster or DEM of the population density."
                },
                {
                    "label": "Min. population in urban centers",
                    "id": "urban_center_threshold",
                    "args_id": "urban_center_threshold",
                    "type": "text",
                    "width": 70,
                    "required": true,
                    "dataType": "int",
                    "validText": "[0-9]+",
                    "defaultValue": "5000",
                    "helpText": "Minimum population required to consider the shore segment a population center."
                },
                {
                    "label": "Coastal neighborhood (radius in m)",
                    "id": "population_radius",
                    "args_id": "population_radius",
                    "type": "text",
                    "width": 70,
                    "required": true,
                    "dataType": "int",
                    "validText": "[0-9]+",
                    "defaultValue": "1000",
                    "helpText": "Radius length in meters used to count the number of people leaving close to the coast."
                },
                {
                    "label": "Additional layer (point shapefile)",
                    "id": "additional_layer_uri",
                    "args_id": "additional_layer_uri",
                    "type": "file",
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "defaultValue":
                    "../CoastalProtection/Input/SeaLevRise_WCVI.shp",
                    "validateAs":{"type":"OGR",
                                  "layers": [{"name": {"inheritFrom":"file"},
                                  "type":"polygons"}]},
                    "helpText": "This layer is going to be treated as the sea level rise, and will be used in the computation of coastal vulnerability and coastal vulnerability without habitat."
                },
                {
                    "label": "Layer value if path omitted",
                    "id": "additional_layer_constant",
                    "args_id": "additional_layer_constant",
                    "type": "text",
                    "width": 70,
                    "required": false,
                    "returns" : {"ifEmpty":"pass"},
                    "dataType": "int",
                    "validText": "[1-5]",
                    "defaultValue": "",
                    "helpText": "Integer value between 1 and 5. If layer associated to this field is omitted, replace all shore points for this layer with a constant rank value in the computation of the coastal vulnerability index. If both the file and value for the layer are omitted, the layer is skipped altogether."
                }
            ]
        }    
    ] 
}
